# 2026-02-21 Daily Memory

## Telegram 发图技巧
- 使用 `message` 工具的 `media` 参数发送本地图片
- **关键**：Telegram 只允许特定目录下的文件，需要把图片复制到 `/Users/mirkozhang/.openclaw/workspace/` 才能发送
- 示例：
  ```python
  message(action="send", target="8526351790", channel="telegram", media="/Users/mirkozhang/.openclaw/workspace/husky.png", message="哈士奇 🐕 在这里！")
  ```

## 哈士奇图片
- 位置：`~/.openclaw/workspace-baogongtou/husky.png`
- 之前用 zenmux-image-gen 生成，已复制到 workspace 目录供发送

---

## 安全委员会测试 (2026-02-21 晚)

### 测试结果
- 4 个 Opus 4.6 专家并行跑完整安全审查
- **消耗了 5 小时额度的 75%** — 代价很高

### 发现的关键安全问题

| 级别 | 问题 |
|------|------|
| 🔴 高危 | 配置备份文件权限 644（含明文 API Key） |
| 🔴 高危 | TAVILY_API_KEY 明文存储，未走 REDACTED 机制 |
| 🔴 高危 | iMessage 崩溃循环导致 45MB 垃圾日志 |
| 🟡 中危 | 日志文件、cron、session 文件权限过宽（644） |
| 🟡 中危 | 缺少 .gitignore，敏感文件无防护 |
| 🟡 中危 | Telegram groupPolicy: "open" 有注入风险 |
| 🟡 中危 | 4/8 cron 任务 delivery failed（配额耗尽期间） |

### 立即可执行的修复命令
```bash
chmod 600 ~/.openclaw/openclaw.json.backup.*
chmod 600 ~/.openclaw/cron/jobs.json ~/.openclaw/cron/jobs.json.bak
chmod 640 ~/.openclaw/logs/*.log
chmod 600 ~/.openclaw/workspace/cookies.json
> ~/.openclaw/logs/gateway.err.log  # 清空 45MB 垃圾日志
```

### 安全审查模型策略（经验教训）
- **Opus × 4 并行** = 75% 5小时额度，太贵，不适合频繁跑
- **推荐方案**：Sonnet 4.6 × 4 专家审查 + Opus 汇总（省 80%+ token）
- **频率建议**：Opus 版每周最多 1 次；Sonnet 版可每天运行

### 安全审查 Prompt 文件
- 位置：`~/.openclaw/workspace-baogongtou/security-review-prompt.md`

### GitHub 同步计划（讨论中）
- 优先用 .gitignore 排除敏感文件（openclaw.json、.env、logs/ 等）
- 安全审查时 Opus 要检查 API Key 泄露风险，输出自动脱敏
- 尚未实施，待后续安排

## Prompt Caching 笔记
- **Claude Sonnet 4.6**（作家）：✅ 支持，省 90% 输入 token
- **GPT-5.2 Codex**（程序员）：✅ 支持，省 90% 输入 token
- **Gemini 3.1 Pro**（研究员）：❌ 不支持
- **MiniMax M2.5**（包工头）：❌ 不支持
- ZenMux 上 Opus 4.6 的 prompt caching 有 bug（Issue #12239）
